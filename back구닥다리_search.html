<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="./myJs.js"></script>
    <link rel="stylesheet" href="./twitter2style.css">
    <link rel="stylesheet" href="./cssforTheSelement.css">
    <script src="./tweetFactory.js"></script>
    <script src="./bot_tweetFactory.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <title>홈 / 트위터</title>
</head>

<body>
    <form action="" method="get">
        <div class="container">
            <div class="left">
                <img src="./images/tinyBird.png" width="35px" height="35px" alt="">
                <input type="button" value="&nbsp&nbsp&nbsp홈" style="cursor:pointer;" onmouseout="f_out(this)"
                    onmouseover="f_over(this)"><br>
                <input type="button" value="&nbsp&nbsp&nbsp탐색하기" style="cursor:pointer;" onmouseout="f_out(this)"
                    onmouseover="f_over(this)"><br>
                <input type="button" value="&nbsp&nbsp&nbsp알림" style="cursor:pointer;" onmouseout="f_out(this)"
                    onmouseover="f_over(this)"><br>
                <input type="button" value="&nbsp&nbsp&nbsp쪽지" style="cursor:pointer;" onmouseout="f_out(this)"
                    onmouseover="f_over(this)"><br>
                <input type="button" value="&nbsp&nbsp&nbsp북마크" style="cursor:pointer;" onmouseout="f_out(this)"
                    onmouseover="f_over(this)"><br>
                <input type="button" value="&nbsp&nbsp&nbsp리스트" style="cursor:pointer;" onmouseout="f_out(this)"
                    onmouseover="f_over(this)"><br>
                <input type="button" value="&nbsp&nbsp&nbsp프로필" style="cursor:pointer;" onmouseout="f_out(this)"
                    onmouseover="f_over(this)"><br>
                <input type="button" value="&nbsp&nbsp&nbsp더 보기" style="cursor:pointer;" onmouseout="f_out(this)"
                    onmouseover="f_over(this)"><br>
                <input id="btn1_left" type="button" value="트윗" style="cursor:pointer;"><br>
                <div id="id_chottoLogout"></div>
                <div id="id_accountProfile">
                    <img src="" width="50px" height="50px" alt="">
                    <input type="button" id="id_downBelow"
                        style="background-image: url(./images/downBelow.png); background-size:contain; cursor: pointer;">
                </div>

            </div>
            <div class="center">
                <div class="home" style="position: fixed;">&nbsp&nbsp홈</div>
                <!-- <div id="id_tweetInput" class="searchTaishouMyTweet">
                    <img src="">
                    <textarea id="id_textArea" cols="15" rows="1" placeholder="무슨 일이 일어나고 있나요?"
                        style="resize: none;"></textarea>
                    <div id="id_showSelectedPhoto"></div>
                    <input type="file" id="id_tempuFile" multiple style="display:none;" accept=".jpg, .jpeg, .png">
                    <input type="file" id="id_tempuGifFile" multiple style="display:none;" accept=".gif">
                    <input class="tempu" type="button" style="background-image: url(./images/tempu1_transparent.png);"
                        onmouseout="f_out(this)" onmouseover="f_over(this)">
                    <input class="tempu" type="button" style="background-image: url(./images/tempu2_transparent.png);"
                        onmouseout="f_out(this)" onmouseover="f_over(this)">
                    <input class="tempu" type="button" style="background-image: url(./images/tempu3_transparent.png);"
                        onmouseout="f_out(this)" onmouseover="f_over(this)">
                    <input class="tempu" type="button" style="background-image: url(./images/tempu4_transparent.png);"
                        onmouseout="f_out(this)" onmouseover="f_over(this)">
                    <input class="tempu" type="button" style="background-image: url(./images/tempu5_transparent.png);"
                        onmouseout="f_out(this)" onmouseover="f_over(this)">
                    <button class="cl_submit" type="button" disabled style="cursor:text;">트윗</button>
                </div> -->
                <div id="id_feedForMe">

                </div>
            </div>
            <div class="right">
                <div id="id_search">
                    <img src="./images/magnifyingGlass.png">
                    <input id="id_searchInput" type="text" value="" placeholder="트위터 검색" autocomplete="off">
                    <div id="id_chottoShow">사용자, 화제, 키워드를 검색해보세요</div>
                </div>
                <div id="id_recommendation">
                    <div style="position: absolute; display: block; width: 310px;
                                height:30px; line-height:25px; top: 8px; font-size: 18px; font-weight: bold;">
                        &nbsp&nbsp나를 위한 트렌드
                        <hr>
                    </div>
                    <img id="id_settingIcon" src="./images/setting.png"
                        style="background-color: transparent; cursor:pointer; width: 25px; height: 25px; border-radius: 12.5px; border: none; left: 275px; top: 11px; position: absolute; display: inline-block;">
                    <div class="cl_recKids" style="height:50px; top: 45px; line-height: 50px;">
                        &nbsp&nbsp코로롱바이러수&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp-대한민국에서 트렌드중
                        <hr>
                    </div>
                    <div class="cl_recKids" style="height:50px; top: 100px; line-height: 50px;">&nbsp&nbsp뷍퉨소녠뒝
                        <hr>
                    </div>
                    <div class="cl_recKids" style="height:50px; top: 155px; line-height: 50px;">&nbsp&nbsp올해 첫 눈
                        <hr>
                    </div>
                    <div class="cl_recKids" style="height:50px; top: 215px; line-height: 50px;">&nbsp&nbsp7월반 파티투나잇?
                        <hr>
                    </div>
                    <div class="cl_recKids" style="height:50px; top: 275px; line-height: 50px;">&nbsp&nbsp데이터베이스 스키마
                        <hr>
                    </div>
                </div>

            </div>
        </div>
        <script>
            //right setting icon 색변경
            var v_settingIcon = document.getElementById("id_settingIcon");
            v_settingIcon.onmouseover = function () {
                this.style.backgroundColor = "rgba(133, 213, 252,0.282)";
            };
            v_settingIcon.onmouseout = function () {
                this.style.backgroundColor = "transparent";
            };

            //right 트렌드 마우스오버/아웃 색변경
            var v_recKids = document.getElementsByClassName("cl_recKids");
            for (var i = 0; i < v_recKids.length; i++) {
                v_recKids[i].addEventListener("mouseover", function () {
                    this.style.backgroundColor = "rgb(233, 238, 242)";
                });
                v_recKids[i].addEventListener("mouseout", function () {
                    this.style.backgroundColor = "transparent";
                });
            }


            var cl_left = document.querySelectorAll(".left")[0];
            var apart = 10;
            var apartTempu = 10;

            var v_tweetInput = document.getElementById("id_tweetInput");

            // 왼쪽 버튼들 상하간격 주기
            for (var i = 0; i < cl_left.children.length; i++) {
                if (cl_left.children[i].type == "button") {
                    cl_left.children[i].style.top = "30px";
                }
                cl_left.children[i].style.top = parseInt(cl_left.children[i].style.top) + apart + "px";
                apart += 25;
            }


            // 마우스오버, 아웃 시 버튼 색 블루로 변경
            function f_over(arg) {
                arg.style.backgroundColor = "rgba(133, 213, 252,0.282)";
                arg.style.border = "1px solid rgba(133, 213, 252,0.282)";
                arg.style.color = "rgb(28, 164, 244)";
            }
            function f_out(arg) {
                arg.style.backgroundColor = "transparent";
                arg.style.border = "1px solid transparent";
                arg.style.color = "black";
            }

            // 검색어 아무것도 없거나 공백일때 체크하기 -나중에

            var v_liked = false;
            //이이네 버튼 누르면 빨간 하트로 이미지 바꿔치기 - ok
            var iineBtns = document.getElementsByClassName("cl_iine");
            for (var i = 0; i < iineBtns.length; i++) {
                iineBtns[i].addEventListener("click", function () {
                    if (!v_liked) {
                        this.style.backgroundImage = "url(./images/heartful.png)";
                        v_liked = true;
                        return;
                    }
                    this.style.backgroundImage = "url(./images/heart.png)";
                    v_liked = false;
                });
            }

            // onload시 왼쪽 하단 미니 프로필에 닉네임(cl_profileId 자식3), @아이디(자식4)

            var v_accountProfile = document.querySelector("#id_accountProfile");
            v_accountProfile.addEventListener("mouseover", f_over.bind(null, v_accountProfile));
            v_accountProfile.addEventListener("mouseout", f_out.bind(null, v_accountProfile));

            window.onload = function () {
                var tableName = "Twitterians";
                var superuser = { eId: "sudo", ePw: "1004", eNickname: "superuser", eImg: "images/sudo.jpg" };
                var users = JSON.parse(localStorage.getItem(tableName));

                var nowId = request.getParameter("nm_id");

                var $v_profileNickname = $("<div></div>");
                // $v_profileNickname.html("아께로");
                $v_profileNickname.attr("class", "cl_profileId").css("position", "absolute");
                $v_profileNickname.appendTo($(v_accountProfile));

                for (var i = 0; i < users.length; i++) {
                    if (nowId == users[i].eId) {
                        $v_profileNickname.html(users[i].eNickname);
                        $(v_accountProfile).children().eq(0).attr("src", users[i].eImg);
                        $(v_tweetInput).children().eq(0).attr("src", users[i].eImg); // 시퀀셜하겡
                        break;
                    }
                }

                var v_profileId = document.createElement("div");
                v_profileId.innerHTML = "@" + nowId;
                $(v_profileId).attr("class", "cl_profileId").css("position", "absolute");
                $(v_accountProfile).append($(v_profileId));

                var v_accountToLogout = document.querySelector("#id_accountProfile").cloneNode(true);
                v_accountToLogout.children[0].style.borderRadius = "25px";
                v_accountToLogout.children[1].style.display = "none";
                $(v_accountToLogout).attr("id", "id_accountToLogout").css({ "border": "1px solid transparent", "backgroundColor": "white" });

                var checkMark = document.createElement("img");
                checkMark.setAttribute("id", "id_checkMark");
                checkMark.src = "./images/checkMarkBlue.png";
                v_accountToLogout.appendChild(checkMark);
                v_chottoLogout.appendChild(v_accountToLogout);

                v_chottoLogout.innerHTML += "<br><hr>";

                var v_addAccount = document.createElement("div");
                v_addAccount.setAttribute("id", "id_addAccount");
                v_addAccount.innerHTML = "&nbsp&nbsp&nbsp&nbsp기존 계정 추가<hr>";
                v_chottoLogout.appendChild(v_addAccount);
                v_addAccount.addEventListener("mouseover", function () {
                    this.style.backgroundColor = "rgb(233, 238, 242)";
                });
                v_addAccount.addEventListener("mouseout", function () {
                    this.style.backgroundColor = "transparent";
                });

                var v_logingOut = document.createElement("div");
                v_logingOut.setAttribute("id", "id_logingOut");
                v_logingOut.innerHTML
                    = "&nbsp&nbsp&nbsp&nbsp@" + request.getParameter("nm_id") + " 님 계정에서 로그아웃";
                v_chottoLogout.appendChild(v_logingOut);
                v_logingOut.addEventListener("mouseover", function () {
                    this.style.backgroundColor = "rgb(233, 238, 242)";
                });
                v_logingOut.addEventListener("mouseout", function () {
                    this.style.backgroundColor = "transparent";
                });

                //v_chottoLogout 내의 v_logingOut을 클릭하면, 로그아웃창으로.
                v_logingOut.addEventListener("click", function () {
                    location.href = "twitterLogout.html";
                });


                //말풍선 모양 만들려고... 그냥 쪼고만 네모.
                var v_semo = document.createElement("div");
                v_semo.setAttribute("id", "id_semo");
                v_chottoLogout.appendChild(v_semo);
            };


            //트윗 검색창

            var v_search = document.querySelector("#id_search");
            // var v_searchInput = v_search.children[1];
            var v_searchInput = document.querySelector("#id_searchInput");
            var v_chottoShow = document.querySelector("#id_chottoShow")

            v_searchInput.addEventListener("click", function () {
                v_search.style.backgroundColor = "white";
                v_search.style.border = "1px solid rgb(28, 164, 244)";
                v_chottoShow.style.display = "inline-block";
                v_chottoShow.style.zIndex = 100;
            });


            v_searchInput.onblur = function () {
                v_search.style.backgroundColor = "rgb(233, 238, 242)";
                v_search.style.border = "1px solid transparent";
                v_chottoShow.style.display = "none";
            };

            // 검색할 키워드 search.html로 get방식 패스
            $(v_searchInput).keypress(function () {
                event.preventDefault();
                if ($(this).val().length != 0 && event.keyCode == 13) { 
                    var userIdToPass = request.getParameter("nm_id");
                    location.href = "search.html?nm_id=" + userIdToPass + "&q=" + $(this).val();
                }
            });

            var v_downBelow = document.getElementById("id_downBelow");
            var v_chottoLogout = document.getElementById("id_chottoLogout");

            var isRun = false;

            //downBelow버튼 누르면 계정선택창 디스플레이를 inline-block으로.
            v_downBelow.addEventListener("click", function () {
                if (!isRun) {
                    v_chottoLogout.style.display = "inline-block";
                    v_accountProfile.style.cursor = "default";
                    isRun = true;
                }
            });
            //downBelow 버튼외의 공간을 누르면 계정선택창을 none으로.
            //이 아니고!! downBelow와 계정선택창 두개를 제외한 공간 선택시 none이되어야함

            v_chottoLogout.addEventListener("mouseleave", function () {
                v_chottoLogout.style.display = "none";
                v_accountProfile.style.cursor = "pointer";
                isRun = false;
            });

            //계정선택창내 두가지 선택지(기존계정추가, 로그아웃)
            //누르면 계정선택창이 닫혀버리는 버그 수정할 것 (完)
            
            $(".cl_iine").click(function () {
                $(this).effect("bounce", { times: 1 }, "fast");
            });

            $(".left").find("input").eq(1).css("color","rgb(28,164,244)");







            $(document).ready(function(){
                tweetFactory();
                botTweetFactory();
            });
        </script>
    </form>
</body>

</html>